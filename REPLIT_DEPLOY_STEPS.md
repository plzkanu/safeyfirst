# Replit 배포 단계별 가이드

GitHub 푸시가 완료되었으니 이제 Replit에 배포하겠습니다!

---

## ✅ 1단계: Replit에서 GitHub 프로젝트 가져오기

### 1.1 Replit 접속 및 프로젝트 생성

1. **Replit 웹사이트 접속**
   - https://replit.com 접속
   - 로그인 (계정이 없으면 회원가입)

2. **새 프로젝트 생성**
   - 왼쪽 상단 **"Create Repl"** 버튼 클릭
   - 또는 **"+"** 아이콘 클릭

3. **GitHub에서 가져오기**
   - **"Import from GitHub"** 탭 선택
   - GitHub 저장소 URL 입력:
     ```
     https://github.com/plzkanu/soosan_safe
     ```
   - 또는 저장소 이름만 입력:
     ```
     plzkanu/soosan_safe
     ```
   - **"Import"** 버튼 클릭

4. **프로젝트 이름 설정** (선택사항)
   - 프로젝트 이름을 원하는 대로 변경 가능
   - 예: "soosan-safe" 또는 "안전관리시스템"

5. **생성 완료**
   - Replit이 자동으로 프로젝트를 가져옵니다
   - 몇 분 정도 소요될 수 있습니다

---

## ✅ 2단계: 환경 변수 설정 (Secrets)

### 2.1 Secrets 탭 열기

1. Replit 왼쪽 사이드바에서 **"Secrets"** 아이콘 클릭
   - 자물쇠 모양 아이콘 또는 "Secrets" 텍스트

### 2.2 환경 변수 추가

다음 변수들을 하나씩 추가합니다:

#### 변수 1: JWT_SECRET
- **Key**: `JWT_SECRET`
- **Value**: 강력한 랜덤 문자열 (최소 32자)
  - 예: `soosan-safety-system-secret-key-2024-production-change-this`
  - 또는 온라인 랜덤 문자열 생성기 사용

#### 변수 2: NODE_ENV
- **Key**: `NODE_ENV`
- **Value**: `production`

#### 변수 3: PORT (선택사항)
- Replit이 자동으로 포트를 할당하므로 생략 가능
- 필요시:
  - **Key**: `PORT`
  - **Value**: `5000`

### 2.3 저장 확인

- 각 변수를 추가한 후 **"Add secret"** 클릭
- 추가된 변수들이 목록에 표시되는지 확인

---

## ✅ 3단계: 의존성 설치

### 3.1 터미널 열기

- Replit 하단의 **"Shell"** 또는 **"Console"** 탭 클릭

### 3.2 의존성 설치 명령어 실행

```bash
npm run install-all
```

이 명령어는 다음을 실행합니다:
- 루트 디렉토리 의존성 설치
- 서버 의존성 설치 (`server/` 폴더)
- 클라이언트 의존성 설치 (`client/` 폴더)

**예상 소요 시간**: 2-5분

**완료 확인**: 
- 오류 메시지가 없으면 성공
- `node_modules` 폴더들이 생성되었는지 확인

---

## ✅ 4단계: 프론트엔드 빌드

### 4.1 빌드 명령어 실행

```bash
npm run build
```

이 명령어는 `client/build` 폴더에 프로덕션 빌드를 생성합니다.

**예상 소요 시간**: 1-3분

**완료 확인**:
- `client/build` 폴더가 생성되었는지 확인
- 빌드 성공 메시지 확인

---

## ✅ 5단계: 서버 실행

### 5.1 실행 방법

**방법 A: Run 버튼 사용 (권장)**
1. Replit 상단의 **"Run"** 버튼 클릭
2. 자동으로 `.replit` 파일의 설정에 따라 실행됩니다

**방법 B: 터미널에서 직접 실행**
```bash
npm run start:prod
```

### 5.2 실행 확인

터미널에서 다음 메시지가 표시되어야 합니다:

```
서버가 포트 XXXX에서 실행 중입니다.
프로덕션 모드: React 빌드 파일을 서빙합니다.
```

**포트 번호**: Replit이 자동으로 할당한 포트 번호가 표시됩니다.

---

## ✅ 6단계: 웹뷰에서 확인

### 6.1 Webview 탭 열기

1. Replit 상단의 **"Webview"** 탭 클릭
2. 또는 자동으로 열릴 수 있습니다

### 6.2 로그인 페이지 확인

- SOOSAN 로고가 표시되는지 확인
- "안전 관리 시스템" 텍스트가 표시되는지 확인
- 로그인 폼이 정상적으로 표시되는지 확인

### 6.3 로그인 테스트

기본 계정으로 로그인 테스트:

**관리자 계정:**
- 사용자명: `admin`
- 비밀번호: `admin123`

**일반 사용자 계정:**
- 사용자명: `user`
- 비밀번호: `user123`

**성공 확인:**
- 로그인 후 대시보드가 표시되면 성공!
- 사이드바 메뉴가 정상적으로 작동하는지 확인

---

## ✅ 7단계: 공개 URL 확인 (선택사항)

### 7.1 Always On 설정 (유료 플랜)

1. Replit 대시보드에서 프로젝트 선택
2. **"Always On"** 옵션 활성화
3. 공개 URL이 생성됩니다

### 7.2 무료 플랜

- 무료 플랜에서는 Replit 세션이 비활성화되면 앱이 중지됩니다
- 외부 접근을 위해서는 Replit의 공개 URL을 사용하거나
- 다른 호스팅 서비스를 고려하세요

---

## 🎉 배포 완료!

축하합니다! 이제 Replit에서 애플리케이션이 실행되고 있습니다!

---

## 🔄 업데이트 배포 (로컬에서 개발 후)

로컬에서 코드를 수정한 후 Replit에 반영하는 방법:

### 1. 로컬에서 변경사항 커밋 및 푸시

```powershell
# 변경사항 추가
git add .

# 커밋
git commit -m "업데이트 내용 설명"

# GitHub에 푸시
git push
```

### 2. Replit에서 Pull

Replit 터미널에서:

```bash
# 최신 변경사항 가져오기
git pull

# 의존성 재설치 (필요시)
npm run install-all

# 프론트엔드 재빌드
npm run build

# 서버 재시작
# Run 버튼 클릭 또는
npm run start:prod
```

---

## 🐛 문제 해결

### 빌드 오류

```bash
# 클라이언트 캐시 삭제 후 재빌드
cd client
rm -rf node_modules build
npm install
npm run build
cd ..
```

### 포트 오류

- Replit이 자동으로 포트를 할당합니다
- 코드는 이미 `0.0.0.0`으로 설정되어 있어 문제없습니다

### 환경 변수 오류

- Secrets 탭에서 변수들이 제대로 설정되었는지 확인
- 변수 이름이 정확한지 확인 (대소문자 구분)

### 데이터베이스 오류

- SQLite 데이터베이스는 `server/database.db`에 저장됩니다
- Replit의 파일 시스템은 영구적이지만, 프로젝트를 삭제하면 데이터도 삭제됩니다
- **중요**: 정기적으로 데이터 백업 권장

---

## 📝 체크리스트

배포 전 확인사항:

- [ ] Replit에서 GitHub 프로젝트 가져오기 완료
- [ ] 환경 변수 설정 완료 (JWT_SECRET, NODE_ENV)
- [ ] 의존성 설치 완료 (`npm run install-all`)
- [ ] 프론트엔드 빌드 완료 (`npm run build`)
- [ ] 서버 실행 확인
- [ ] Webview에서 로그인 페이지 확인
- [ ] 로그인 기능 테스트 완료

---

## 💡 팁

1. **개발과 배포 분리**
   - 로컬에서 개발
   - Replit은 배포 및 테스트용으로 사용

2. **Git 사용**
   - GitHub와 연동하여 버전 관리
   - 변경사항을 쉽게 배포

3. **로깅 확인**
   - Replit 터미널에서 서버 로그 확인
   - 오류 발생 시 즉시 확인 가능

4. **데이터 백업**
   - 정기적으로 `server/database.db` 파일 백업
   - 또는 데이터베이스 마이그레이션 스크립트 작성

---

다음 단계로 진행하세요! 🚀

